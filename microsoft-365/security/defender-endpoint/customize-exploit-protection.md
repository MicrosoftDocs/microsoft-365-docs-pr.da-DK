---
title: Tilpasse udnyttelsesbeskyttelse
keywords: Exploit protection, afhjælpninger, enable, powershell, dep, cfg, emet, aslr
description: Du kan aktivere eller deaktivere bestemte afhjælpninger, der anvendes ved at udnytte beskyttelsen ved Windows Sikkerhed-appen eller PowerShell. Du kan også overvåge afhjælpninger og eksportkonfigurationer.
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.localizationpriority: medium
audience: ITPro
ms.topic: conceptual
author: dansimp
ms.author: dansimp
ms.reviewer: ''
manager: dansimp
ms.technology: mde
ms.collection: m365-security-compliance
ms.date: ''
ms.openlocfilehash: b52238069a69a08921fec79c67ab979bd7668bb7
ms.sourcegitcommit: bdd6ffc6ebe4e6cb212ab22793d9513dae6d798c
ms.translationtype: MT
ms.contentlocale: da-DK
ms.lasthandoff: 03/08/2022
ms.locfileid: "63592937"
---
# <a name="customize-exploit-protection"></a>Tilpasse udnyttelsesbeskyttelse

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


**Gælder for:**
- [Microsoft Defender for Endpoint Plan 1](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft Defender for Endpoint Plan 2](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> Vil du opleve Defender til Slutpunkt? [Tilmeld dig for at få en gratis prøveversion.](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-assignaccess-abovefoldlink)

Exploit Protection anvender automatisk en række afhjælpningsteknikker på både operativsystemets processer og individuelle apps.

Konfigurer disse indstillinger ved hjælp Windows Sikkerhed-appen på en enkelt enhed. Eksportér derefter konfigurationen som en XML-fil, så du kan installere den på andre enheder. Brug Gruppepolitik at distribuere XML-filen til flere enheder på én gang. Du kan også konfigurere afhjælpningerne med PowerShell.

I denne artikel beskrives hver af de afhjælpninger, der er tilgængelige med hensyn til udnyttelse af beskyttelsen. Den angiver, om afhjælpningen kan anvendes i hele systemet eller i individuelle apps, og giver en kort beskrivelse af, hvordan afhjælpningen fungerer.

Den beskriver også, hvordan du aktiverer eller konfigurerer afhjælpningerne ved hjælp af Windows Sikkerhed, PowerShell og udbydere af konfigurationstjenesteudbydere til mobilenheder (MDM). Dette er det første trin i oprettelsen af en konfiguration, som du kan implementere på tværs af dit netværk. Det næste trin [indebærer oprettelse, eksport, import og implementering af konfigurationen på flere enheder](import-export-exploit-protection-emet-xml.md).

> [!WARNING]
> Nogle teknologier til afhjælpning af sikkerhed kan have kompatibilitetsproblemer med visse programmer. Du bør teste udnyttelsesbeskyttelse i alle scenarier for målbrug ved [](evaluate-exploit-protection.md) hjælp af overvågningstilstand, før du implementerer konfigurationen på tværs af et produktionsmiljø eller resten af dit netværk.

## <a name="exploit-protection-mitigations"></a>Afhjælpning af udnyttelse

Alle afhjælpninger kan konfigureres for individuelle apps. Visse afhjælpninger kan også anvendes på operativsystemniveau.

Du kan indstille hver enkelt af afhjælpningerne til, fra eller til deres standardværdi. Nogle afhjælpninger har yderligere muligheder, der er angivet i beskrivelsen i tabellen.

Standardværdier angives altid i kantede parenteser på **indstillingen Brug standardindstillingen** for hver afhjælpning. I følgende eksempel er standardindstillingen for Forebyggelse af datakørsel "Til".

Brug **standardkonfigurationen** for hver af indstillingerne for afhjælpning indikerer vores anbefaling om et grundlæggende beskyttelsesniveau til det daglige brug for private brugere. Virksomhedsinstallationer skal overveje den beskyttelse, der kræves til deres individuelle behov, og de skal muligvis ændre konfigurationen væk fra standardindstillingerne.

Du kan finde oplysninger om de tilknyttede PowerShell-cmdlet'er for hver afhjælpning i [referencetabellen for PowerShell](#cmdlets-table) nederst i denne artikel.

|Afhjælpning|Beskrivelse|Kan anvendes på|Overvågningstilstand er tilgængelig|
|---|---|---|---|
|Control flow guard (CFG)|Sikrer kontrolflowintegritet for indirekte opkald. Kan vælge at undertrykke eksporter og bruge restriktive CFG'er.|System- og appniveau|Nej|
|Forhindring af datakørsel|Forhindrer, at kode køres fra hukommelsessider, der kun indeholder data, f.eks. heap og stakke. Kan kun konfigureres til 32-bit (x86)-apps, aktiveres permanent for alle andre arkitekturer. Du kan også vælge at aktivere ATL-emulering.|System- og appniveau|Nej|
|Gennemtving randomisering af billeder (mandatory ASLR)|Forcibly flytter billeder, der ikke er kompileret med /DYNAMICBASE. Kan du vælge ikke at indlæse billeder, der ikke har oplysninger, du skal bruge.|System- og appniveau|Nej|
|Randomisere hukommelsesallokering (Bund-Op ASLR)|Randomiserer placeringer for allokering af virtuel hukommelse. Den indeholder systemstrukturbæmmer, stakke, TEBs og PEBs. Kan vælge at bruge en bredere randomiseringsafvigelse for 64-bit processer.|System- og appniveau|Nej|
|Valider undtagelseskæder (SEHOP)|Sikrer integriteten af en undtagelseskæde under afsendelse af undtagelser. Kan kun konfigureres til 32-bit (x86)-programmer.|System- og appniveau|Nej|
|Valider heap integritet|Afslutter en proces, når der registreres beskadigelse af dynen.|System- og appniveau|Nej|
|Vilkårlig code guard (ACG)|Forhindrer introduktion af ikke-billed-sikkerhedskopieret eksekverbar kode og forhindrer, at kodesider ændres. Du kan også vælge at tillade fravalg af tråd og tillade fjernnedgradering (kan kun konfigureres med PowerShell).|Kun på appniveau|Ja|
|Bloker billeder med lav integritet|Forhindrer indlæsning af billeder, der er markeret med lav integritet.|Kun på appniveau|Ja|
|Bloker eksterne billeder|Forhindrer indlæsning af billeder fra eksterne enheder.|Kun på appniveau|Nej|
|Bloker upålidelige skrifttyper|Forhindrer indlæsning af GDI-baserede skrifttyper, der ikke er installeret i mappen med systemskrifttyper, dvs. skrifttyper fra internettet.|Kun på appniveau|Ja|
|Code integrity guard|Begrænser indlæsning af billeder, der er signeret af Microsoft, WHQL eller nyere. Du kan også tillade Microsoft Store signerede billeder.|Kun på appniveau|Ja|
|Deaktiver udvidelsespunkter|Deaktiverer forskellige udvidelsesmekanismer, der gør det muligt at foretage DLL-indrykning i alle processer, f.eks. AppInit-DLL'er, vindues hooks og Winsock-tjenesteudbydere.|Kun på appniveau|Nej|
|Deaktiver Win32k-systemopkald|Forhindrer en app i at bruge opkaldstabellen Win32k-systemet.|Kun på appniveau|Ja|
|Tillad ikke underordnede processer|Forhindrer, at en app opretter underordnede processer.|Kun på appniveau|Ja|
|Eksportér adressefiltrering (EAF)|Registrerer skadelige handlinger, der løses ved hjælp af skadelig kode. Kan du vælge at validere adgangen for moduler, der ofte bruges af udnyttelse.|Kun på appniveau|Ja|
|Importér adressefiltrering (IAF)|Registrerer skadelige handlinger, der løses ved hjælp af skadelig kode.|Kun på appniveau|Ja|
|Simulere udførelse (SimExec)|Sikrer, at opkald til følsomme API'er vender tilbage til legitime opkaldere. Kan kun konfigureres til 32-bit (x86)-programmer. Ikke kompatibel med ACG.|Kun på appniveau|Ja|
|Valider API-aktivering (CallerCheck)|Sikrer, at følsomme API'er aktiveres af legitime opkaldere. Kan kun konfigureres til 32-bit (x86)-programmer. Ikke kompatibel med ACG|Kun på appniveau|Ja|
|Valider håndteringsforbrug|Medfører, at der opstår en undtagelse for ugyldige håndtagsreferencer.|Kun på appniveau|Nej|
|Valider billedes afhængighedsintegritet|Gennemtvinger signering af kode for Windows af billede ved indlæsning.|Kun på appniveau|Nej|
|Valider stakintegritet (StackPivot)|Sikrer, at stakken ikke er blevet omdirigeret til følsomme API'er. Ikke kompatibel med ACG.|Kun på appniveau|Ja|

> [!IMPORTANT]
> Hvis du føjer en app til sektionen **Programindstillinger** og konfigurerer individuelle afhjælpningsindstillinger der, vil de blive imødekommet ovenfor konfigurationen for de samme afhjælpninger, der er angivet i sektionen **Systemindstillinger** . Følgende matrix og eksempler hjælper med at illustrere, hvordan standardindstillinger fungerer:
>
>
> |Aktiveret i **programindstillinger**|Aktiveret i **Systemindstillinger**|Funktionsmåde|
> |---|---|---|
> |Ja|Nej|Som defineret i **Programindstillinger**|
> |Ja|Ja|Som defineret i **Programindstillinger**|
> |Nej|Ja|Som defineret i **Systemindstillinger**|
> |Nej|Ja|Standard som defineret i **Brug standardindstilling**|
>
>
> - **Eksempel 1**
>
>    Konfigurer Forhindring af **datakørsel i sektionen** **Systemindstillinger** til at være **slået Fra som standard**.
>
>    Derefter føjes app *-test.exe* til **sektionen Programindstillinger** . I indstillingerne for den pågældende app under **Forhindring af datakørsel aktiverer** han indstillingen Tilsidesæt **systemindstillinger** og indstiller **indstillingen Til.** Der er ikke angivet andre apps i **sektionen Programindstillinger** .
>
>    Resultatet er, at DEP kun bliver aktiveret for *test.exe*. Der er ikke anvendt DEP i alle andre apps.
>
>
> - **Eksempel 2**
>
>    Josie konfigurerer **Forhindring af datakørsel i** sektionen **Systemindstillinger** til at være **slået Fra som standard**.
>
>    Josie føjer derefter app *-test.exe* til **sektionen Programindstillinger** . I indstillingerne for den pågældende app under **Forhindring af datakørsel aktiverer** hun indstillingen Tilsidesæt **systemindstillinger** og indstiller **indstillingen Til.**
>
>    Josie føjer også app *-miles.exe* **til sektionen Programindstillinger** og konfigurerer **Control flow guard (CFG)** **til Til**. Hun aktiverer ikke indstillingen **Tilsidesæt systemindstillinger** for dep eller andre afhjælpninger for den pågældende app.
>
>    Resultatet er, at DEP bliver aktiveret for *test.exe*. DEP aktiveres ikke for andre apps, herunder *miles.exe*. CFG aktiveres for *miles.exe*.

> [!NOTE]
> Hvis du har fundet problemer i denne artikel, kan du rapportere det direkte til en Windows Server/Windows-klientpartner eller bruge Microsofts tekniske supportnumre for dit land.

### <a name="configure-system-level-mitigations-with-the-windows-security-app"></a>Konfigurere afhjælpninger på systemniveau med Windows Sikkerhed appen

1. Åbn appen Windows Sikkerhed ved at vælge skjoldikonet på proceslinjen eller søge i menuen Start efter **Windows Sikkerhed**.

2. Vælg **flisen & appstyring** (eller appikonet på menulinjen til venstre), og vælg derefter **Exploit protection**.

3. Find den **afhjælpning,** du vil konfigurere, i sektionen Systemindstillinger, og vælg en af følgende. Apps, der ikke er konfigureret enkeltvis i sektionen **Programindstillinger** , bruger de indstillinger, der er konfigureret her:
   - **Til som standard** – Afhjælpningen er *aktiveret* for apps, som ikke har indstillet denne afhjælpning i den appspecifikke **programindstillingssektion**
   - **Deaktiveret som** standard – Afhjælpningen *er deaktiveret* for apps, som ikke har indstillet denne afhjælpning i den appspecifikke **sektion Programindstillinger**
   - **Brug som** standard – Afhjælpningen er enten aktiveret eller deaktiveret, afhængigt af den standardkonfiguration, der er konfigureret i Windows 10- eller Windows 11-installationen. Standardværdien **(Til** eller **Fra) er** altid angivet ud for Brug  standardetiketten for hver afhjælpning

   > [!NOTE]
   > Du får muligvis vist vinduet Kontrol af brugerkonti, når du ændrer nogle indstillinger. Angiv administratorens legitimationsoplysninger for at anvende indstillingen.

   Det kan kræve en genstart at ændre nogle indstillinger.

4. Gentag dette for alle de afhjælpninger på systemniveau, du vil konfigurere.

5. Gå til sektionen **Programindstillinger** , og vælg den app, du vil anvende afhjælpninger på:

   1. Hvis den app, du vil konfigurere, allerede er angivet, skal du markere den og derefter vælge **Rediger**
   2. Hvis appen ikke vises, skal du øverst på listen vælge Tilføj **program** for at tilpasse og derefter vælge, hvordan du vil tilføje appen:
      - Brug **Tilføj efter programnavn for at** sikre, at afhjælpningen anvendes på alle kørende processer med det pågældende navn. Du skal angive en fil med filtypenavn. Du kan gå hele vejen for at begrænse afhjælpningen til kun at være appen med det pågældende navn på den pågældende placering.
      - Brug **Vælg den nøjagtige sti til** filen for at bruge Windows Stifinder-filvælgervindue til at finde og vælge den ønskede fil.

6. Når du har valgt appen, får du vist en liste over alle de afhjælpninger, der kan anvendes. Du kan afhjælpe afhjælpningen ved at markere afkrydsningsfeltet og derefter ændre skyderen til **Til**. Vælg eventuelle yderligere indstillinger. Hvis du **vælger Overvågning** , anvendes afhjælpningen kun i overvågningstilstand. Du får besked, hvis du skal genstarte processen eller appen, eller hvis du skal genstarte Windows.

7. Gentag disse trin for alle de apps og afhjælpninger, du vil konfigurere. Vælg **Anvend** , når du er færdig med konfigurationen.

Du kan nu [eksportere disse indstillinger som en XML-fil](import-export-exploit-protection-emet-xml.md) eller fortsætte med at konfigurere appspecifikke afhjælpninger.

Ved at eksportere konfigurationen som en XML-fil kan du kopiere konfigurationen fra én enhed til andre enheder.

## <a name="powershell-reference"></a>PowerShell-reference

Du kan bruge Windows Sikkerhed konfigurere Exploit Protection, eller du kan bruge PowerShell-cmdlet'er.

De konfigurationsindstillinger, der senest blev ændret, vil altid blive anvendt , uanset om du bruger PowerShell eller Windows Sikkerhed. Det betyder, at hvis du bruger appen til at konfigurere en afhjælpning og derefter bruger PowerShell til at konfigurere den samme afhjælpning, opdateres appen, så den viser de ændringer, du har foretaget med PowerShell. Hvis du derefter bruger appen til at ændre afhjælpningen igen, vil denne ændring gælde.

> [!IMPORTANT]
> De ændringer, der installeres på en enhed via Gruppepolitik, tilsidesætter den lokale konfiguration. Når du konfigurerer en indledende konfiguration, skal du bruge en enhed, der ikke har en Gruppepolitik konfiguration for at sikre, at dine ændringer ikke tilsidesættes.

Du kan bruge PowerShell-verbum `Get` eller `Set` med cmdlet'en `ProcessMitigation`. Når `Get` du bruger denne liste, vises den aktuelle konfigurationsstatus for eventuelle afhjælpninger, der er blevet aktiveret på enheden – `-Name` tilføj cmdlet'en og app-exe for at se afhjælpninger for netop den pågældende app:

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> Afhjælpninger på systemniveau, der ikke er konfigureret, viser en status for `NOTSET`.
>
> For indstillinger på systemniveau angiver den `NOTSET` standardindstilling, for hvilken afhjælpningen er blevet anvendt.
>
> For indstillinger på appniveau angiver `NOTSET` det, at indstillingen på systemniveau for afhjælpningen vil blive anvendt.
>
> Standardindstillingen for hver afhjælpning på systemniveau kan ses i Windows Sikkerhed.

Bruges `Set` til at konfigurere hver afhjælpning i følgende format:

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

Hvor:

- \<Scope\>:
  - `-Name` for at indikere, at afhjælpningerne bør anvendes på en bestemt app. Angiv appens eksekverbare navn efter dette flag.
  - `-System` for at indikere, at afhjælpningen skal anvendes på systemniveau
- \<Action\>:
  - `-Enable` for at afhjælpe afhjælpningen
  - `-Disable` for at deaktivere afhjælpningen
- \<Mitigation\>:
  - Afhjælpningens cmdlet som defineret i tabellen med [cmdlet'er](#cmdlets-table) til afhjælpning nedenfor sammen med eventuelle undermuligheder (omgivet af mellemrum). Hver afhjælpning er adskilt med et komma.

Hvis du f.eks. vil aktivere afhjælpning af forhindring af datakørsel med ATL-ekvemulation og for en eksekverbar *fil kaldettesting.exe* i mappen *C:\Apps\LOB\tests*, og for at forhindre eksekverbare filer i at oprette underordnede processer, skal du bruge følgende kommando:

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> Adskid hver afhjælpningsindstilling med kommaer.

Hvis du vil anvende DEP på systemniveau, skal du bruge følgende kommando:

```PowerShell
Set-Processmitigation -System -Enable DEP
```

For at deaktivere afhjælpninger kan du erstatte `-Enable` med `-Disable`. Men for afhjælpninger på appniveau vil dette tvinge afhjælpningen til kun at blive deaktiveret for den pågældende app.

Hvis du har brug for at gendanne afhjælpningen tilbage til systemstandarden, `-Remove` skal du også inkludere cmdlet'en, som i følgende eksempel:

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

Du kan også indstille nogle afhjælpninger til overvågningstilstand. I stedet for at bruge PowerShell-cmdlet'en til afhjælpning, kan du **bruge** cmdlet'en i overvågningstilstand som angivet i tabellen med [cmdlet'er for afhjælpning](#cmdlets-table) nedenfor.

Hvis du f.eks. vil aktivere Vilkårlig Code Guard (ACG) i overvågningstilstand for de *testing.exe* tidligere, skal du bruge følgende kommando:

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable AuditDynamicCode
```

Du kan deaktivere overvågningstilstand ved hjælp af den samme kommando, men erstatte med `-Enable` `-Disable`.

### <a name="powershell-reference-table"></a>PowerShell-referencetabel

I denne tabel vises de PowerShell-cmdlet'er (og den tilknyttede overvågningstilstand), som kan bruges til at konfigurere hver afhjælpning.

<a id="cmdlets-table"></a>

|Afhjælpning|Gælder for|PowerShell-cmdlet'er|Cmdlet i overvågningstilstand|
|---|---|---|---|
|Control flow guard (CFG)|System- og appniveau|CFG, StrictCFG, SuppressExports|Overvågning er ikke tilgængelig|
|Forhindring af datakørsel|System- og appniveau|DEP, EmulateAtlThunks|Overvågning er ikke tilgængelig|
|Gennemtving randomisering af billeder (mandatory ASLR)|System- og appniveau|ForceRelocateImages|Overvågning er ikke tilgængelig|
|Randomisere hukommelsesallokering (Bund-Op ASLR)|System- og appniveau|BottomUp, HighEntropy|Overvågning er ikke tilgængelig|
|Valider undtagelseskæder (SEHOP)|System- og appniveau|SEHOP, SEHOPTelemetri|Overvågning er ikke tilgængelig|
|Valider heap integritet|System- og appniveau|TerminateOnError|Overvågning er ikke tilgængelig|
|Vilkårlig code guard (ACG)|Kun på appniveau|DynamicCode|AuditDynamicCode|
|Bloker billeder med lav integritet|Kun på appniveau|BlockLowLabel|AuditImageLoad|
|Bloker eksterne billeder|Kun på appniveau|BlockRemoteImages|Overvågning er ikke tilgængelig|
|Bloker upålidelige skrifttyper|Kun på appniveau|DisableNonSystemFonts|AuditFont, FontAuditOnly|
|Code integrity guard|Kun på appniveau|BlockNonMicrosoftSigned, AllowStoreSigned|AuditMicrosoftSigned, AuditStoreSigned|
|Deaktiver udvidelsespunkter|Kun på appniveau|ExtensionPoint|Overvågning er ikke tilgængelig|
|Deaktiver Win32k-systemopkald|Kun på appniveau|DisableWin32kSystemCalls|AuditSystemCall|
|Tillad ikke underordnede processer|Kun på appniveau|DisallowProcessCreation|AuditProcess|
|Eksportér adressefiltrering (EAF)|Kun på appniveau|EnableExportAddressFilterPlus, EnableExportAddressFilter <a href="#r1" id="t1">\[1\]</a>|Overvågning er ikke <a href="#r2" id="t2">tilgængelig2\[\]</a>|
|Importér adressefiltrering (IAF)|Kun på appniveau|EnableImportAddressFilter|Overvågning er ikke <a href="#r2" id="t2">tilgængelig2\[\]</a>|
|Simulere udførelse (SimExec)|Kun på appniveau|EnableRopSimExec|Overvågning er ikke <a href="#r2" id="t2">tilgængelig2\[\]</a>|
|Valider API-aktivering (CallerCheck)|Kun på appniveau|EnableRopCallerCheck|Overvågning er ikke <a href="#r2" id="t2">tilgængelig2\[\]</a>|
|Valider håndteringsforbrug|Kun på appniveau|StrictHandle|Overvågning er ikke tilgængelig|
|Valider billedes afhængighedsintegritet|Kun på appniveau|EnforceModuleDepencySigning|Overvågning er ikke tilgængelig|
|Valider stakintegritet (StackPivot)|Kun på appniveau|EnableRopStackPivot|Overvågning er ikke <a href="#r2" id="t2">tilgængelig2\[\]</a>|

<a href="#t1" id="r1">\[1\]</a>: Brug følgende format til at aktivere EAF-moduler for dll-filer for en proces:

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```

<a href="#t2" id="r2">\[2\]</a>: Overvågning af denne afhjælpning er ikke tilgængelig via PowerShell-cmdlet'er.

## <a name="customize-the-notification"></a>Tilpasse meddelelsen

Du kan finde flere oplysninger om tilpasning af meddelelsen, når en regel udløses og blokerer en app eller fil, [under Windows Sikkerhed](/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center).

## <a name="see-also"></a>Se også

- [Beskyt enheder mod udnyttelse](exploit-protection.md)
- [Evaluer udnyttelsesbeskyttelse](evaluate-exploit-protection.md)
- [Aktivér udnyttelse af beskyttelse](enable-exploit-protection.md)
- [Importere, eksportere og implementere konfigurationer af exploit protection](import-export-exploit-protection-emet-xml.md)
